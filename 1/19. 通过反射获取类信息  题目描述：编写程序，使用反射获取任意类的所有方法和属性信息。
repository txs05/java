
import java.lang.reflect.*;
import java.util.Arrays;

// 示例类用于测试
class Student {
    private String name;
    private int age;
    public static final String SCHOOL = "清华大学";
    
    public Student() {}
    
    public Student(String name, int age) {
        this.name = name;
        this.age = age;
    }
    
    public String getName() {
        return name;
    }
    
    public void setName(String name) {
        this.name = name;
    }
    
    public int getAge() {
        return age;
    }
    
    public void setAge(int age) {
        this.age = age;
    }
    
    private void study() {
        System.out.println(name + "正在学习");
    }
    
    public static void showSchool() {
        System.out.println("学校: " + SCHOOL);
    }
}

public class ReflectionExample {
    
    public static void main(String[] args) {
        System.out.println("========== 反射获取类信息 ==========\n");
        
        try {
            // 1. 获取Class对象的三种方式
            System.out.println("【1. 获取Class对象】");
            Class<?> clazz1 = Student.class;
            Class<?> clazz2 = Class.forName("Student");
            Class<?> clazz3 = new Student().getClass();
            
            System.out.println("方式1 - Student.class: " + clazz1.getName());
            System.out.println("方式2 - Class.forName(): " + clazz2.getName());
            System.out.println("方式3 - getClass(): " + clazz3.getName());
            System.out.println("三个Class对象是否相等: " + 
                             (clazz1 == clazz2 && clazz2 == clazz3));
            
            // 2. 获取类的基本信息
            System.out.println("\n【2. 类的基本信息】");
            System.out.println("类名: " + clazz1.getName());
            System.out.println("简单类名: " + clazz1.getSimpleName());
            System.out.println("包名: " + clazz1.getPackageName());
            System.out.println("修饰符: " + Modifier.toString(clazz1.getModifiers()));
            
            // 3. 获取所有字段（属性）
            System.out.println("\n【3. 所有字段信息】");
            Field[] fields = clazz1.getDeclaredFields();
            System.out.println("字段总数: " + fields.length);
            for (Field field : fields) {
                System.out.println("  字段名: " + field.getName());
                System.out.println("  字段类型: " + field.getType().getSimpleName());
                System.out.println("  修饰符: " + Modifier.toString(field.getModifiers()));
                System.out.println();
            }
            
            // 4. 获取所有方法
            System.out.println("【4. 所有方法信息】");
            Method[] methods = clazz1.getDeclaredMethods();
            System.out.println("方法总数: " + methods.length);
            for (Method method : methods) {
                System.out.println("  方法名: " + method.getName());
                System.out.println("  返回类型: " + method.getReturnType().getSimpleName());
                
                // 获取参数信息
                Class<?>[] paramTypes = method.getParameterTypes();
                System.out.println("  参数类型: " + Arrays.toString(paramTypes));
                System.out.println("  修饰符: " + Modifier.toString(method.getModifiers()));
                System.out.println();
            }
            
            // 5. 获取构造方法
            System.out.println("【5. 构造方法信息】");
            Constructor<?>[] constructors = clazz1.getDeclaredConstructors();
            System.out.println("构造方法总数: " + constructors.length);
            for (Constructor<?> constructor : constructors) {
                System.out.println("  构造方法名: " + constructor.getName());
                Class<?>[] paramTypes = constructor.getParameterTypes();
                System.out.println("  参数类型: " + Arrays.toString(paramTypes));
                System.out.println("  修饰符: " + Modifier.toString(constructor.getModifiers()));
                System.out.println();
            }
            
            // 6. 动态创建对象并调用方法
            System.out.println("【6. 动态操作示例】");
            
            // 创建对象
            Constructor<?> constructor = clazz1.getConstructor(String.class, int.class);
            Object student = constructor.newInstance("张三", 20);
            
            // 调用公有方法
            Method getNameMethod = clazz1.getMethod("getName");
            String name = (String) getNameMethod.invoke(student);
            System.out.println("调用getName(): " + name);
            
            // 设置私有字段
            Field ageField = clazz1.getDeclaredField("age");
            ageField.setAccessible(true);  // 设置可访问
            ageField.set(student, 21);
            System.out.println("设置age为: " + ageField.get(student));
            
            // 调用私有方法
            Method studyMethod = clazz1.getDeclaredMethod("study");
            studyMethod.setAccessible(true);
            System.out.print("调用私有方法study(): ");
            studyMethod.invoke(student);
            
            // 调用静态方法
            Method showSchoolMethod = clazz1.getMethod("showSchool");
            System.out.print("调用静态方法: ");
            showSchoolMethod.invoke(null);
            
        } catch (ClassNotFoundException e) {
            System.out.println("类未找到: " + e.getMessage());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
